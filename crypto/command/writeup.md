# Command Writeup
コマンドの暗号化と暗号化したコマンドを実行してくれるサービス。
fizzbuzz, primes, getflagの3つのコマンドがあるが、getflagという文字列が入っている場合はコマンドを暗号化してくれない。

暗号化に使われているのはAESのCBCモードで、このCBCモードでは暗号文のとある1ビットを反転させると次のブロックの同じ場所のビットが反転するという特徴があります。
しかし当然暗号なので書き換えたブロック自体が壊れてしまいます。

今回の場合は暗号化するデータが1ブロック分しかないので、IVを使うことでブロックを壊さずに平文を書き換えられます。
IVは初期化ベクトルと言い、CBCモードで暗号化の処理をする上で足りないブロックを補うために付け足されます。
IVは便宜上暗号文のように振る舞いつつ復号後には除去されるので、ビット反転の攻撃をする上ではうってつけのブロックです。

あとは適宜ビット反転をして `getflag` の暗号文を作ればいいのですが、文字数が同じ他のコマンドはありません。
暗号化時に後ろにパディングが付け足されるのでそのパディングの値を予想して値を合わせる必要があります。
